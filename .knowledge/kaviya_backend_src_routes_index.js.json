{"is_source_file": true, "format": "JavaScript", "description": "This file defines Express.js route handlers for a children's educational app backend. It handles user signup/login, fetching quizzes, submitting quiz answers, retrieving child profiles, and managing rewards. It interacts with MongoDB through Mongoose models and includes authentication and authorization middleware.", "external_files": ["../models/User.js", "../models/Quiz.js", "../models/Progress.js", "../models/Reward.js", "../utils/errors.js", "../middleware/auth.js"], "external_methods": ["bcrypt.hash", "bcrypt.compare", "mongoose.isValidObjectId", "mongoose.Types.ObjectId", "User.findOne", "User.create", "User.findById", "Reward.create", "Reward.findOne", "Progress.create", "Progress.find", "Progress.countDocuments", "Progress.aggregate", "Quiz.findOne", "generateToken"], "published": ["router"], "classes": [], "methods": [{"name": "signup", "description": "Creates a new user (kid or parent), generates a token, and optionally creates a reward for kids."}, {"name": "login", "description": "Authenticates a user and returns a login token with user info."}, {"name": "getQuiz", "description": "Fetches quiz questions for a specific subject, optionally revealing answers."}, {"name": "getDashboard", "description": "Returns basic profile info (xp, level, badges) for a child, accessible to the child or authorized parent."}, {"name": "submitQuiz", "description": "Processes quiz answers submitted by a kid, updates XP, level, badges, progress, and rewards accordingly."}, {"name": "getParentStats", "description": "Provides aggregate stats and recent attempts for a child, accessible to a parent."}, {"name": "getRewards", "description": "Retrieves reward state for a kid or linked child, including pet stage, stickers, and spin availability."}], "calls": ["User.findOne", "User.create", "bcrypt.hash", "generateToken", "User.findOne", "bcrypt.compare", "generateToken", "Quiz.findOne", "Progress.create", "User.findById", "Reward.findOne", "Progress.find", "Progress.countDocuments", "Progress.aggregate", "User.findById", "Reward.findOne"], "search-terms": ["signup", "login", "quiz", "submit-quiz", "dashboard", "rewards", "parent", "kid", "auth", "progress", "gamification"], "state": 2, "file_id": 13, "knowledge_revision": 27, "git_revision": "", "ctags": [{"_type": "tag", "name": "LEVEL_XP", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const LEVEL_XP = 100;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "STICKER_POOL", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const STICKER_POOL = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "XP_PER_CORRECT", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const XP_PER_CORRECT = 10;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const router = express.Router();$/", "language": "JavaScript", "kind": "constant"}], "hash": "38353bec74f9580463373563b3ffac19", "format-version": 4, "code-base-name": "kaviya_backend", "filename": "kaviya_backend/src/routes/index.js", "revision_history": [{"27": ""}]}