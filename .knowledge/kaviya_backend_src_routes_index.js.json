{"is_source_file": true, "format": "JavaScript (Node.js with Express)", "description": "This file defines various API routes for a learning platform backend. It includes endpoints for user signup and login, fetching quizzes, submitting quiz answers, retrieving user dashboards, managing rewards, and permission-controlled access for parents and kids. The code interacts with MongoDB models such as User, Quiz, Progress, and Reward, and utilizes middleware for authentication and authorization.", "external_files": ["../models/User.js", "../models/Quiz.js", "../models/Progress.js", "../models/Reward.js", "../utils/errors.js", "../middleware/auth.js"], "external_methods": ["bcrypt.hash", "bcrypt.compare", "mongoose.isValidObjectId", "mongoose.Types.ObjectId", "User.findOne", "User.create", "User.findById", "Reward.create", "Reward.findOne", "Progress.create", "Progress.find", "Progress.countDocuments", "Progress.aggregate", "Quiz.findOne", "res.status", "res.json", "res.send", "console.log", "generateToken", "authenticate", "authorize"], "published": ["router"], "classes": [], "methods": [{"name": "POST /signup", "description": "Creates a new user; if role is 'kid', also creates a Reward document and returns an auth token and user info."}, {"name": "POST /login", "description": "Authenticates a user with username and password, returning a token and user info."}, {"name": "GET /quiz/:subject", "description": "Fetches a quiz for a given subject, optionally revealing answers."}, {"name": "GET /dashboard/:id", "description": "Returns a kid's profile data such as XP, level, and badges, ensuring proper permissions."}, {"name": "POST /submit-quiz", "description": "Evaluates quiz answers, updates progress, XP, level, badges, and reward state."}, {"name": "GET /parent/:id", "description": "Provides aggregated stats for a child's quiz attempts, accessible to linked parent."}, {"name": "GET /rewards/:id", "description": "Returns reward info for a kid, either self or linked child."}], "calls": ["User.findOne", "User.create", "bcrypt.hash", "generateToken", "User.findOne", "bcrypt.compare", "generateToken", "Quiz.findOne", "Progress.find", "Progress.countDocuments", "Progress.aggregate", "User.findById", "Reward.findOne", "Reward.create", "Progress.create"], "search-terms": ["signup", "login", "quiz retrieval", "submit quiz", "dashboard", "parent child stats", "rewards", "auth middleware", "user models", "progress tracking"], "state": 2, "file_id": 13, "knowledge_revision": 44, "git_revision": "f5f1ab800a5d8d9f9e5f28a827169affadd1ab9e", "revision_history": [{"27": ""}, {"43": "f5f1ab800a5d8d9f9e5f28a827169affadd1ab9e"}, {"44": "f5f1ab800a5d8d9f9e5f28a827169affadd1ab9e"}], "ctags": [{"_type": "tag", "name": "LEVEL_XP", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const LEVEL_XP = 100;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "STICKER_POOL", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const STICKER_POOL = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "XP_PER_CORRECT", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const XP_PER_CORRECT = 10;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/routes/index.js", "pattern": "/^const router = express.Router();$/", "language": "JavaScript", "kind": "constant"}], "hash": "964e18048fec5b8f6af7251a54354e02", "format-version": 4, "code-base-name": "kaviya_backend", "filename": "kaviya_backend/src/routes/index.js"}