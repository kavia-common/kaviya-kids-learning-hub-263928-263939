{"is_source_file": true, "format": "JavaScript", "description": "This file contains middleware functions for handling JSON Web Token (JWT) authentication and authorization in an Express.js application. It includes functions to generate tokens, verify incoming tokens, and authorize user roles.", "external_files": ["../utils/errors.js"], "external_methods": ["jwt.sign", "jwt.verify"], "published": [], "classes": [], "methods": [{"name": "generateToken(payload)", "description": "Generates a JWT token for a user based on provided payload with user ID and role.", "scope": "", "scopeKind": ""}, {"name": "authenticate(req, res, next)", "description": "Express middleware to verify JWT token from request headers and attach the decoded user info to the request object.", "scope": "", "scopeKind": ""}, {"name": "authorize(roles = [])", "description": "Returns middleware that checks if the authenticated user has one of the allowed roles.", "scope": "", "scopeKind": ""}], "calls": ["jwt.sign", "jwt.verify"], "search-terms": ["auth", "JWT", "middleware", "jsonwebtoken", "verifyToken", "role-based access"], "state": 2, "file_id": 12, "knowledge_revision": 25, "git_revision": "", "ctags": [{"_type": "tag", "name": "authenticate", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^export function authenticate(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}, {"_type": "tag", "name": "authorize", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^export function authorize(roles = []) {$/", "language": "JavaScript", "kind": "function", "signature": "(roles = [])"}, {"_type": "tag", "name": "generateToken", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^export function generateToken(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^    req.user = { id: decoded.id, role: decoded.role };$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^    req.user = { id: decoded.id, role: decoded.role };$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^    req.user = { id: decoded.id, role: decoded.role };$/", "language": "JavaScript", "kind": "class", "scope": "req", "scopeKind": "class"}], "hash": "95146c61d331af80680da74aabf3ebdb", "format-version": 4, "code-base-name": "kaviya_backend", "filename": "kaviya_backend/src/middleware/auth.js", "fields": [{"name": "req.user = { id: decoded.id, role: decoded.role };", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"25": ""}]}