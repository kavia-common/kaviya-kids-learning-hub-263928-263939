{"is_source_file": true, "format": "JavaScript", "description": "This file contains middleware functions for handling authentication and authorization using JSON Web Tokens (JWT). It provides functions to generate tokens, verify tokens attached to incoming requests, and enforce role-based access control.", "external_files": ["jsonwebtoken", "../utils/errors.js"], "external_methods": ["jwt.sign", "jwt.verify", "ApplicationError"], "published": ["generateToken", "authenticate", "authorize"], "classes": [], "methods": [{"name": "generateToken(payload, expiresIn = '7d')", "description": "Creates a JWT token for a specific payload, with configurable expiry, and throws an ApplicationError if JWT secret is missing.", "scope": "", "scopeKind": ""}, {"name": "authenticate(req, res, next)", "description": "Express middleware to verify incoming JWT tokens in request headers and attach user info to the request object.", "scope": "", "scopeKind": ""}, {"name": "authorize(roles = [])", "description": "Generates middleware that enforces user role-based access control, allowing only specific roles.", "scope": "", "scopeKind": ""}], "calls": ["jwt.sign", "jwt.verify", "new ApplicationError"], "search-terms": ["auth middleware", "JWT token generation", "role-based authorization", "express middleware"], "state": 2, "file_id": 12, "knowledge_revision": 51, "git_revision": "63da38611da39692d28a435a12ff3d13c1432791", "revision_history": [{"25": ""}, {"51": "63da38611da39692d28a435a12ff3d13c1432791"}], "ctags": [{"_type": "tag", "name": "authenticate", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^export function authenticate(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}, {"_type": "tag", "name": "authorize", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^export function authorize(roles = []) {$/", "language": "JavaScript", "kind": "function", "signature": "(roles = [])"}, {"_type": "tag", "name": "generateToken", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^export function generateToken(payload, expiresIn = '7d') {$/", "language": "JavaScript", "kind": "function", "signature": "(payload, expiresIn = '7d')"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^    req.user = { id: decoded.id, role: decoded.role };$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^    req.user = { id: decoded.id, role: decoded.role };$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/kaviya-kids-learning-hub-263928-263939/kaviya_backend/src/middleware/auth.js", "pattern": "/^    req.user = { id: decoded.id, role: decoded.role };$/", "language": "JavaScript", "kind": "class", "scope": "req", "scopeKind": "class"}], "hash": "c82a67f7771385faf1983e34b67400f4", "format-version": 4, "code-base-name": "kaviya_backend", "filename": "kaviya_backend/src/middleware/auth.js", "fields": [{"name": "req.user = { id: decoded.id, role: decoded.role };", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}]}